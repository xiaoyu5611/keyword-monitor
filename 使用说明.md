# 📱 关键词监控系统 - 详细使用说明

## 🎯 系统概述

这是一个完整的关键词监控解决方案，可以监控Android手机上的输入内容，当检测到设置的关键词时，立即在管理后台显示警告。

---

## 📦 第一步：安装和部署后端

### 自动安装（推荐）

```bash
cd /www/wwwroot/keyword-monitor
chmod +x install.sh
./install.sh
```

### 手动安装

```bash
cd /www/wwwroot/keyword-monitor/backend
npm install
```

---

## 🚀 第二步：启动后端服务

### 方式一：使用启动脚本（推荐）

```bash
cd /www/wwwroot/keyword-monitor
./start.sh
```

### 方式二：手动启动

```bash
cd /www/wwwroot/keyword-monitor/backend
npm start
```

启动成功后，你会看到：
```
✅ 服务器运行在 http://localhost:3000
📊 管理后台: http://localhost:3000
🔌 API地址: http://localhost:3000/api
```

---

## 💻 第三步：访问管理后台

在浏览器中打开：`http://localhost:3000`

或局域网内其他设备访问：`http://你的IP地址:3000`

### 管理后台功能：

1. **关键词管理** - 添加/删除要监控的关键词
2. **警告通知** - 实时显示关键词触发记录
3. **设备管理** - 查看所有连接的设备
4. **统计信息** - 查看监控统计数据

---

## 📱 第四步：编译Android应用

### 使用Android Studio（推荐）

1. 打开Android Studio
2. 选择 "Open an Existing Project"
3. 选择 `/www/wwwroot/keyword-monitor/android` 目录
4. 等待Gradle同步完成
5. 点击 "Build" > "Build Bundle(s) / APK(s)" > "Build APK(s)"
6. APK生成位置：`android/app/build/outputs/apk/debug/app-debug.apk`

### 使用命令行

```bash
cd /www/wwwroot/keyword-monitor/android
./gradlew assembleDebug
```

编译成功后，APK位于：
`android/app/build/outputs/apk/debug/app-debug.apk`

---

## 📲 第五步：安装和配置Android应用

### 1. 安装APK

将 `app-debug.apk` 传输到手机并安装

### 2. 配置服务器地址

1. 打开"关键词监控"应用
2. 在"服务器设置"中输入后端地址
   - 例如：`http://192.168.1.100:3000`
   - **重要**：必须使用局域网IP，不要使用localhost
3. 点击"💾 保存服务器地址"

### 3. 启用辅助功能

1. 点击"🚀 启用辅助功能"
2. 系统会打开辅助功能设置
3. 找到"关键词监控"
4. 打开开关并授予权限
5. 阅读说明后点击"允许"

---

## ✅ 第六步：开始使用

### 1️⃣ 在管理后台添加关键词

打开管理后台，在"关键词管理"中添加要监控的关键词，例如：
- 密码
- 银行卡
- 身份证
- 等等...

### 2️⃣ 测试监控功能

在手机上打开任意应用（如微信、记事本等），输入包含关键词的内容

### 3️⃣ 查看警告通知

返回管理后台，在"警告通知"区域会实时显示：
- 📱 设备名称
- 🔴 触发的关键词
- 💬 相关文本内容
- ⏰ 触发时间

---

## 🔧 常见问题解决

### 1. 后端无法启动

**问题**：运行 `./start.sh` 时提示错误

**解决**：
```bash
# 检查Node.js是否安装
node -v
npm -v

# 重新安装依赖
cd backend
rm -rf node_modules
npm install
```

### 2. Android应用无法连接服务器

**问题**：应用提示连接失败

**解决**：
- 确保手机和电脑在同一WiFi网络
- 使用电脑的局域网IP，不要用localhost
- 检查防火墙是否阻止了3000端口
- Linux防火墙设置：
  ```bash
  sudo ufw allow 3000
  ```

### 3. 辅助功能无法启用

**问题**：找不到"关键词监控"选项

**解决**：
- 确保APK已正确安装
- 重启手机后再试
- 检查系统版本（需要Android 5.0+）

### 4. 没有收到警告通知

**问题**：输入关键词后管理后台无反应

**解决**：
- 检查辅助功能是否已启用
- 检查服务器地址是否正确
- 在应用中查看状态是否显示"运行中"
- 刷新管理后台页面
- 检查后端日志

---

## 📊 获取服务器IP地址

### Linux/macOS

```bash
# 方式1
ip addr show | grep inet

# 方式2
ifconfig | grep inet

# 方式3
hostname -I
```

### Windows

```cmd
ipconfig
```

查找 "IPv4 地址"，通常是 `192.168.x.x` 格式

---

## 🔒 安全提示

1. **仅在可信设备上使用**
   - 本系统会监听设备输入内容
   - 请确保您有权限监控目标设备

2. **网络安全**
   - 建议仅在内网使用
   - 如需公网访问，请配置HTTPS和身份验证

3. **数据安全**
   - 所有数据存储在本地SQLite数据库
   - 数据库文件位于：`backend/monitor.db`

---

## 🛠️ 高级配置

### 修改服务器端口

编辑 `backend/server.js` 或设置环境变量：
```bash
PORT=8080 npm start
```

### 修改数据保存位置

编辑 `backend/server.js`，找到：
```javascript
const db = new Database('./monitor.db');
```

修改为：
```javascript
const db = new Database('/path/to/your/database.db');
```

### 开机自启动（Linux）

创建systemd服务：
```bash
sudo nano /etc/systemd/system/keyword-monitor.service
```

内容：
```ini
[Unit]
Description=Keyword Monitor Service
After=network.target

[Service]
Type=simple
User=your-username
WorkingDirectory=/www/wwwroot/keyword-monitor/backend
ExecStart=/usr/bin/node server.js
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

启用服务：
```bash
sudo systemctl enable keyword-monitor
sudo systemctl start keyword-monitor
```

---

## 📞 技术支持

如遇到其他问题：

1. 查看后端日志
2. 查看Android应用日志（使用adb logcat）
3. 检查网络连接
4. 重启所有服务

---

## 🎉 完成！

现在你已经成功部署了关键词监控系统！

- ✅ 后端服务运行中
- ✅ 管理后台可访问
- ✅ Android应用已安装
- ✅ 开始监控关键词

祝使用愉快！ 🚀









