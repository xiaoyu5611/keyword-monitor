# 🔥 必看！退出APP后持续运行设置（关键）

## ⚠️ 核心问题

**辅助功能服务应该独立运行，不需要APP在后台**！但是国产手机厂商会自动杀掉后台服务。

---

## ✅ 完整解决方案（按顺序做）

### 📱 小米/红米手机（MIUI）

#### 1️⃣ 电池优化 - **最重要**
```
设置 → 应用设置 → 应用管理 → 关键词监控
→ 省电策略 → 选择"无限制"
```

#### 2️⃣ 自启动
```
设置 → 应用设置 → 应用管理 → 关键词监控
→ 自启动 → 打开
```

#### 3️⃣ 后台弹出界面
```
设置 → 应用设置 → 应用管理 → 关键词监控
→ 后台弹出界面 → 允许
```

#### 4️⃣ 锁定在后台
```
打开最近任务 → 找到"关键词监控" → 下拉锁定（显示小锁图标）
```

#### 5️⃣ 神隐模式
```
设置 → 电池与性能 → 神隐模式 → 应用配置
→ 找到"关键词监控" → 选择"无限制"
```

---

### 📱 华为/荣耀手机

#### 1️⃣ 应用启动管理 - **最关键**
```
设置 → 应用 → 应用启动管理 → 找到"关键词监控"
→ 关闭"自动管理"
→ 手动设置：
  ✅ 允许自启动
  ✅ 允许关联启动
  ✅ 允许后台活动
```

#### 2️⃣ 电池优化
```
设置 → 电池 → 更多电池设置 → 休眠时始终保持网络连接
→ 打开
```

#### 3️⃣ 锁定后台
```
最近任务 → 下拉"关键词监控" → 锁定
```

---

### 📱 OPPO/一加/真我手机

#### 1️⃣ 电池优化 - **核心**
```
设置 → 电池 → 应用耗电管理 → 找到"关键词监控"
→ 选择"允许后台运行"
```

#### 2️⃣ 自启动管理
```
设置 → 应用管理 → 应用列表 → 关键词监控
→ 权限 → 自启动 → 允许
```

#### 3️⃣ 后台冻结
```
设置 → 电池 → 更多 → 智能后台冻结
→ 关闭（或将关键词监控加入白名单）
```

---

### 📱 vivo手机

#### 1️⃣ 后台高耗电 - **必须设置**
```
设置 → 电池 → 后台高耗电
→ 找到"关键词监控" → 允许后台高耗电
```

#### 2️⃣ 自启动
```
设置 → 更多设置 → 权限管理 → 权限
→ 自启动 → 关键词监控 → 允许
```

#### 3️⃣ 后台管理
```
i管家 → 应用管理 → 权限管理 → 自启动
→ 关键词监控 → 允许
```

---

### 📱 三星手机

#### 1️⃣ 电池优化
```
设置 → 应用程序 → 关键词监控 → 电池
→ 优化电池用量 → 选择"不受限"
```

#### 2️⃣ 后台限制
```
设置 → 应用程序 → 关键词监控
→ 电池 → 后台使用限制 → 移除限制
```

---

### 📱 魅族手机

```
设置 → 电量管理 → 待机耗电管理 → 待机耗电应用
→ 关键词监控 → 允许后台运行
```

---

## 🔧 通用设置（所有手机）

### ✅ 1. 辅助功能必须启用
```
设置 → 辅助功能 → 已安装的服务
→ 关键词监控 → 打开（必须保持开启）
```

### ✅ 2. 忽略电池优化（自动弹出）
```
打开APP时会自动弹出请求
→ 点击"允许"
```

### ✅ 3. 通知栏常驻
```
启用辅助功能后，通知栏会显示"关键词监控运行中"
→ 这个通知不要关闭！
→ 它确保服务不被杀
```

---

## 🧪 测试是否成功

### 完成所有设置后：

#### 1️⃣ 打开APP检查状态
```
应该显示：
📊 服务状态: 🟢 运行中
```

#### 2️⃣ 完全退出APP
```
方法1: 按Home键
方法2: 多任务清理（但不要清理"关键词监控"）
```

#### 3️⃣ 等待5分钟

#### 4️⃣ 测试输入
```
打开微信或任意输入应用
输入关键词
检查管理后台是否收到警告
```

#### 5️⃣ 成功标志
```
✅ 通知栏显示"关键词监控运行中"
✅ 管理后台收到警告
✅ Telegram收到通知（如果配置了）
```

---

## ❌ 如果还是不行

### 最后的杀手锏（针对所有手机）

#### 方法1：保持APP在最近任务中
```
1. 打开APP
2. 按Home键（不要清理后台）
3. 在最近任务中锁定APP（下拉显示锁图标）
4. 不要清理APP
```

#### 方法2：重启手机
```
完成所有设置后，重启手机
重启后辅助功能会自动启动
```

#### 方法3：手动重启辅助功能
```
如果发现不工作了：
1. 设置 → 辅助功能 → 关键词监控
2. 关闭 → 等3秒 → 重新打开
```

---

## 🎯 各品牌手机快速配置清单

### 小米/红米
- [ ] 省电策略：无限制
- [ ] 自启动：开启
- [ ] 后台弹出：允许
- [ ] 神隐模式：无限制
- [ ] 锁定后台

### 华为/荣耀
- [ ] 关闭自动管理
- [ ] 允许自启动
- [ ] 允许关联启动
- [ ] 允许后台活动
- [ ] 锁定后台

### OPPO/一加
- [ ] 允许后台运行
- [ ] 允许自启动
- [ ] 关闭后台冻结
- [ ] 锁定后台

### vivo
- [ ] 允许后台高耗电
- [ ] 允许自启动
- [ ] i管家设置
- [ ] 锁定后台

---

## 💡 为什么会被杀？

### 原因：
1. **国产手机太激进** - 为了省电，疯狂杀后台
2. **电池优化** - 默认会限制所有APP
3. **清理软件** - 自动清理"无用"后台
4. **系统更新** - 更新后设置可能被重置

### 解决核心：
1. ⭐ **电池优化白名单** - 最重要
2. ⭐ **自启动权限** - 重启后自动运行
3. ⭐ **锁定后台** - 防止被清理
4. ⭐ **前台服务通知** - 保持服务优先级

---

## 📝 检查清单（出问题时检查）

```
□ 辅助功能是否开启？（设置 → 辅助功能）
□ 通知栏是否显示"关键词监控运行中"？
□ 电池优化是否允许？（无限制/不受限）
□ 自启动是否允许？
□ APP是否被锁定在后台？
□ 最近任务中是否清理了APP？
□ 手机是否开启了省电模式？（关闭它）
□ 是否使用了清理软件？（停用或加白名单）
```

---

## 🚀 最佳实践

### 安装后必做（5步曲）：

1. **安装APK** → 打开APP
2. **配置服务器** → 输入地址并保存
3. **启用辅助功能** → 允许所有权限
4. **设置电池优化** → 选择"无限制"
5. **锁定后台** → 最近任务下拉锁定

### 日常维护：

- ✅ 不要使用清理软件清理APP
- ✅ 不要在最近任务中清理APP
- ✅ 手机重启后检查一次状态
- ✅ 系统更新后重新检查设置

---

## 📞 仍然不行？

### 最后确认：

```bash
# 在管理后台查看设备最后在线时间
访问: http://38.49.29.167:3000
查看"已连接设备"
如果"最后在线"是很久以前 → 服务被杀了
如果"最后在线"是刚才 → 服务正常，检查关键词设置
```

### 终极解决方案：

**使用旧版Android手机或原生Android系统**
- Google Pixel系列
- Android One设备
- LineageOS等第三方ROM
- 不要使用：小米、华为、OPPO、vivo的最新系统

---

**记住：完成所有设置后，最好重启一次手机！**

🎉 配置完成后，即使完全退出APP，只要辅助功能开启，就会一直监控！








